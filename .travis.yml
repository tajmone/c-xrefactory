language: c
sudo: false
dist: trusty
script:
    - make
    - cd tests; make all
if:
    NOT tag = stable
after_success:
    - git config --global user.email "builds@travis-ci.com"
    - git config --global user.name "Travis CI"
    - export GIT_TAG=stable
    - git tag -f -a -m "Latest stable build generated from TravisCI build $TRAVIS_BUILD_NUMBER" $GIT_TAG
    - git push https://$TAGPERM@github.com/$TRAVIS_REPO_SLUG $GIT_TAG  -f --tags
